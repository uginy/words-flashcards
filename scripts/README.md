# Test Scripts

## API Chunks Test (`test-api-chunks.ts`)

ะขะตััะพะฒัะน ัะบัะธะฟั ะดะปั ะฟัะพะฒะตัะบะธ API ะพะฑัะฐะฑะพัะบะธ ัะปะพะฒ ั ัะฐะฝะบะฐะผะธ. ะะพะผะพะณะฐะตั ะฒััะฒะปััั ะฟัะพะฑะปะตะผั ั ะฝะตะบะพััะตะบัะฝัะผะธ JSON ะพัะฒะตัะฐะผะธ ะธ ะฐะฝะฐะปะธะทะธัะพะฒะฐัั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั API.

### ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

- โ ะขะตััะธััะตั 20 ัะตะฐะปัะฝัั ะตะฒัะตะนัะบะธั ัะปะพะฒ ัะฐะทะฝัั ะบะฐัะตะณะพัะธะน
- โ ะะฐะทะฑะธะฒะฐะตั ัะปะพะฒะฐ ะฝะฐ ัะฐะฝะบะธ ะฟะพ 5 (ะบะฐะบ ะฒ ัะตะฐะปัะฝะพะผ ะฟัะธะปะพะถะตะฝะธะธ)
- โ ะะพะดัะพะฑะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะบะฐะถะดะพะณะพ ะทะฐะฟัะพัะฐ ะธ ะพัะฒะตัะฐ
- โ ะะฑะฝะฐััะถะตะฝะธะต ะฟัะพะฑะปะตะผ ั ะฝะตะบะพััะตะบัะฝัะผะธ JSON
- โ ะกัะฐัะธััะธะบะฐ ััะฟะตัะฝัั/ะฝะตัะดะฐัะฝัั ะทะฐะฟัะพัะพะฒ
- โ ะะฝะฐะปะธะท ัะธะฟะพะฒ ะพัะธะฑะพะบ (JSON parsing, network, API, validation)
- โ ะะฐะดะตัะถะบะฐ ะผะตะถะดั ะทะฐะฟัะพัะฐะผะธ ะดะปั ะฟัะตะดะพัะฒัะฐัะตะฝะธั rate limiting
- โ ะะพะฝัะธะณััะฐัะธั ัะตัะตะท ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

### ะะฐะฟััะบ

#### ะัะฝะพะฒะฝะพะน ะทะฐะฟััะบ
```bash
# ะะฐะฟััะบ ั ะฝะฐัััะพะนะบะฐะผะธ ะฟะพ ัะผะพะปัะฐะฝะธั
bun run test:api-chunks

# ะะปะธ ะฝะฐะฟััะผัั ัะตัะตะท npx
npx tsx scripts/test-api-chunks.ts
```

#### ะก ะบะฐััะพะผะฝัะผะธ ะฝะฐัััะพะนะบะฐะผะธ
```bash
# ะะฐััะพะผะฝะฐั ะผะพะดะตะปั
OPENROUTER_MODEL="anthropic/claude-3-sonnet" bun run test:api-chunks

# ะะฐััะพะผะฝัะน API ะบะปัั
OPENROUTER_API_KEY="your-api-key-here" bun run test:api-chunks

# ะัะธะฝัะดะธัะตะปัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะธะฝััััะผะตะฝัะพะฒ
FORCE_TOOL_SUPPORT=true bun run test:api-chunks

# ะะพะผะฑะธะฝะฐัะธั ะฝะฐัััะพะตะบ
OPENROUTER_MODEL="openai/gpt-4" FORCE_TOOL_SUPPORT=false bun run test:api-chunks
```

#### ะะพะผะพัั
```bash
npx tsx scripts/test-api-chunks.ts --help
```

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

| ะะตัะตะผะตะฝะฝะฐั | ะะฟะธัะฐะฝะธะต | ะะฝะฐัะตะฝะธะต ะฟะพ ัะผะพะปัะฐะฝะธั |
|------------|----------|----------------------|
| `OPENROUTER_API_KEY` | API ะบะปัั OpenRouter | ะะท ะบะพะฝัะธะณััะฐัะธะธ |
| `OPENROUTER_MODEL` | ะะพะดะตะปั ะดะปั ัะตััะธัะพะฒะฐะฝะธั | ะะท ะบะพะฝัะธะณััะฐัะธะธ |
| `FORCE_TOOL_SUPPORT` | ะัะธะฝัะดะธัะตะปัะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะธะฝััััะผะตะฝัั | Auto-detect |

### ะขะตััะพะฒัะต ะดะฐะฝะฝัะต

ะกะบัะธะฟั ะธัะฟะพะปัะทัะตั 20 ัะตะฐะปัะฝัั ะตะฒัะตะนัะบะธั ัะปะพะฒ:

**ะะปะฐะณะพะปั (ืคืืขื):**
- ืืืืื (to eat)
- ืืืืช (to go)  
- ืืืืจ (to speak)
- ืืืชืื (to write)
- ืืงืจืื (to read)

**ะกััะตััะฒะธัะตะปัะฝัะต (ืฉื ืขืฆื):**
- ืกืคืจ (book)
- ืืืช (house)
- ืืื (water)
- ืืืื (food)
- ืืืจ (friend)

**ะัะธะปะฐะณะฐัะตะปัะฝัะต (ืฉื ืชืืืจ):**
- ืืืื (big)
- ืงืื (small)
- ืืคื (beautiful)
- ืืื (good)
- ืจืข (bad)

**ะคัะฐะทั (ืคืจืืืช):**
- ืื ืฉืืืื (how are you)
- ืืืงืจ ืืื (good morning)
- ืชืืื ืจืื (thank you very much)
- ืกืืืื (excuse me)
- ืฉืืื (hello/goodbye)

### ะัะฒะพะด ะธะฝัะพัะผะฐัะธะธ

ะกะบัะธะฟั ะฟัะตะดะพััะฐะฒะปัะตั ะดะตัะฐะปัะฝัั ะธะฝัะพัะผะฐัะธั:

#### ะะปั ะบะฐะถะดะพะณะพ ัะฐะฝะบะฐ:
- ๐ ะะฐัะฐะปะพ ะพะฑัะฐะฑะพัะบะธ ั ัะฟะธัะบะพะผ ัะปะพะฒ
- โ/โ ะะตะทัะปััะฐั ะพะฑัะฐะฑะพัะบะธ
- โฑ๏ธ ะัะตะผั ะพะฑัะฐะฑะพัะบะธ
- ๐ ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั ะฟะพ ะบะฐะถะดะพะผั ัะปะพะฒั
- ๐ ะะฝะฐะปะธะท ะพัะธะฑะพะบ (ะตัะปะธ ะตััั)

#### ะคะธะฝะฐะปัะฝะฐั ััะฐัะธััะธะบะฐ:
- ๐ ะะฑัะธะต ัะตะทัะปััะฐัั (ััะฟะตัะฝัะต/ะฝะตัะดะฐัะฝัะต ัะฐะฝะบะธ)
- ๐ ะกัะฐัะธััะธะบะฐ ะฟะพ ัะปะพะฒะฐะผ
- โฑ๏ธ ะะฝัะพัะผะฐัะธั ะพ ะฒัะตะผะตะฝะธ
- ๐ ะะฐะทะฑะธะฒะบะฐ ะพัะธะฑะพะบ ะฟะพ ัะธะฟะฐะผ
- ๐ ะะตัะฐะปัะฝัะน ะฐะฝะฐะปะธะท ะพัะธะฑะพะบ
- ๐ก ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ะธัะฟัะฐะฒะปะตะฝะธั

### ะัะธะผะตัั ะฒัะฒะพะดะฐ

#### ะฃัะฟะตัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะฐะฝะบะฐ:
```
[2025-01-28T10:15:30.123Z] ๐ Starting processing Chunk 1 (5 words: ืืืืื, ืืืืช, ืืืืจ, ืืืชืื, ืืงืจืื)
[2025-01-28T10:15:32.456Z] โ Successfully processed Chunk 1 (5 words: ืืืืื, ืืืืช, ืืืืจ, ืืืชืื, ืืงืจืื)
   ๐ Processing time: 2333ms
   ๐ Words processed: 5
   ๐ Detailed results:
      1. ืืืืื (ืคืืขื)
         Transcription: โ "le'echol"
         Translation: โ "ะตััั"
         Conjugations: โ
         Examples: โ (2)
```

#### ะัะธะฑะบะฐ JSON ะฟะฐััะธะฝะณะฐ:
```
[2025-01-28T10:15:35.789Z] โ Failed to process Chunk 2 (5 words: ืกืคืจ, ืืืช, ืืื, ืืืื, ืืืจ)
   ๐ฅ Error type: json_parse
   ๐ Error message: Failed to parse LLM response content as JSON
   โฑ๏ธ Processing time: 1876ms
   ๐ Error analysis:
   ๐จ Potential JSON issues detected:
      - Response is only an opening brace "{"
```

#### ะคะธะฝะฐะปัะฝะฐั ััะฐัะธััะธะบะฐ:
```
๐ FINAL TEST STATISTICS
========================================
๐ Overall Results:
   Total chunks processed: 4
   Successful chunks: 3 (75%)
   Failed chunks: 1 (25%)

๐ Word Processing:
   Total words: 20
   Successfully processed: 15 (75%)
   Failed to process: 5 (25%)

โฑ๏ธ Timing:
   Total test time: 12s
   Average chunk processing time: 2156ms

๐ Error Breakdown:
   JSON parsing errors: 1
   Network errors: 0
   API errors: 0
   Validation errors: 0
```

### ะะฝะฐะปะธะท ะฟัะพะฑะปะตะผ

ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒััะฒะปัะตั ะธ ะฐะฝะฐะปะธะทะธััะตั:

1. **JSON parsing errors** - ะฝะตะบะพััะตะบัะฝัะน JSON ะฒ ะพัะฒะตัะต
   - ะะตะทะฐะบััััะต ัะบะพะฑะบะธ
   - Markdown ะพะฑัััะบะธ (```json)
   - ะะตะฟะพะปะฝัะต ะพะฑัะตะบัั
   - ะขะพะปัะบะพ ะพัะบััะฒะฐััะฐั ัะบะพะฑะบะฐ "{"

2. **Network errors** - ะฟัะพะฑะปะตะผั ั ัะตััั
   - ะขะฐะนะผะฐััั
   - ะะตะดะพัััะฟะฝะพััั API

3. **API errors** - ะพัะธะฑะบะธ API
   - ะะตะฒะตัะฝัะน ะบะปัั
   - ะัะตะฒััะตะฝะธะต ะปะธะผะธัะพะฒ
   - ะะตะดะพัััะฟะฝะฐั ะผะพะดะตะปั

4. **Validation errors** - ะพัะธะฑะบะธ ะฒะฐะปะธะดะฐัะธะธ ะดะฐะฝะฝัั
   - ะะตะพะถะธะดะฐะตะผะฐั ััััะบัััะฐ ะพัะฒะตัะฐ
   - ะััััััะฒัััะธะต ะฟะพะปั

### Exit ะบะพะดั

- `0` - ะัะต ัะฐะฝะบะธ ะพะฑัะฐะฑะพัะฐะฝั ััะฟะตัะฝะพ
- `1` - ะััั ะฝะตัะดะฐัะฝัะต ัะฐะฝะบะธ

### ะขัะตะฑะพะฒะฐะฝะธั

- Node.js 18+
- ะฃััะฐะฝะพะฒะปะตะฝะฝัะต ะทะฐะฒะธัะธะผะพััะธ (`bun install`)
- ะะฐะปะธะดะฝัะน API ะบะปัั OpenRouter